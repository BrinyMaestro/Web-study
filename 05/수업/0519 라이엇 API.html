<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <style>
        *{margin: 0; padding: 0; box-sizing: border-box;}
        #container {width: 1000px; margin: 0 auto;}

        .profile1 {border: 1px solid rgb(150, 150, 150);}
        .profile2 {display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid rgb(150, 150, 150);}
        .tier img {width: 100px;}
        .tier p {display: flex;}
        .profile3 {display: flex; justify-content: space-between;}
        .kda20 {display: flex;}
    </style>


</head>
<body>
    <div id="container">
        <label for="" style="text-align: center;">유저 <input type="text" id="user"></label> <button>검색</button>
    
        <section class="profile1">
            <div class="profile2">
                <div class="img"><img src="https://opgg-static.akamaized.net/meta/images/profile_icons/profileIcon5766.jpg?image=q_auto,f_webp,w_auto&v=1684436046850" width="150px" alt="가붕이미지"></div>
                <div class="name">
                    <h2>가붕가붕가붕가붕</h2>
                    <h2>Level <span class="level"> 00</span></h2>
                </div>
                <div class="tier">
                    <img src="https://support-leagueoflegends.riotgames.com/hc/article_attachments/4415894930323/Challenger_Emblem_2022.png" alt="">
                    <h2>챌</h2>
                    <p>승률 <span class="percent">99</span>% (<span class="win">ㅇ</span>승 <span class="lose">ㅇ</span>패)</p>
                </div>
            </div>
            <div class="profile3">
                <div class="kda20">
                    <div class="percent2">
                        <h3>승률 <span>ㅇㅇ</span>%</h3>
                        <p><span>ㅇ</span>승 <span>ㅇ</span>패</p>
                    </div>
                    <div class="kda2">
                        <h3>KDA <span>ㅇㅇ</span></h3>
                        <p><span class="kill">ㅇ</span> / <span class="death">ㅇ</span> / <span>ㅇ</span></p>
                    </div>
                </div>
                <div class="position20">
                    <p>20개 게임의 포지션</p>
                    <p>탑<span class=top>0</span> 미드<span class="mid">0</span> 원딜<span class="bottom">0</span> 서폿<span class="supporter">0</span> 정글<span class="jungle">0</span></p>
                </div>
                <div class="champion20">
                    <p>20개 게임의 최근 챔피언</p>
                    <p class="champions">여기에 챔피언 들어감</p>
                </div>
            </div>
        </section>

    </div>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
        // summoner api로 유저 데이터를 가져오는 부분
        const api키 = "RGAPI-faa5b101-a82c-480b-96c3-23b7eb132e70"
        let 검색할유저
        let 소환사puuid
        let 소환사id
        const 인풋태그 = document.querySelector("#user")
        const 검색버튼 = document.querySelector("button")
        const 티어 = document.querySelector(".tier h2")
        const 승률 = document.querySelector(".tier .percent")
        const 승 = document.querySelector(".win")
        const 패 = document.querySelector(".lose")
        const 티어이미지 = document.querySelector(".tier img")

        let summonerAPI
        let leagueAPI

        검색버튼.addEventListener("click", async function() { // 검색버튼 클릭하면 (이벤트 발생)
            검색할유저 = 인풋태그.value // input 태그에 들어있는 value를 가져오기
           
           // summonerAPI 를 호출하는 부분
           await 소환사API()
           // LEAGUEAPI를 호출하는 부분
           await 리그API()

        })

        async function 소환사API() {
            summonerAPI = `https://kr.api.riotgames.com/lol/summoner/v4/summoners/by-name/${검색할유저}?api_key=${api키}`
            let response = await axios.get(summonerAPI)
        
                console.log(response)

                소환사id = response.data.id
                소환사puuid = response.data.puuid

                // 소환사 이름 변경
                const 이름 = document.querySelector(".name h2")
                이름.textContent = response.data.name
 
                // 소환사 레벨 변경
                const 레벨 = document.querySelector(".name .level")
                레벨.textContent = response.data.summonerLevel

                // 소환사 프사 변경
                const 프사 = document.querySelector(".img img")
                프사.setAttribute("src", `https://opgg-static.akamaized.net/meta/images/profile_icons/profileIcon${response.data.profileIconId}.jpg?image=q_auto,f_webp,w_auto&v=1684436046850`)
 
        }
        
        async function 리그API() {
          
            leagueAPI = `https://kr.api.riotgames.com/lol/league/v4/entries/by-summoner/${소환사id}?api_key=${api키}`
            let response = await axios.get(leagueAPI)
            console.log(response)
            
            티어.textContent = response.data[0].tier + " " + response.data[0].rank
            승률.textContent = ((response.data[0].wins / (response.data[0].wins + response.data[0].losses))*100).toFixed(2)
            승.textContent = response.data[0].wins
            패.textContent = response.data[0].losses
            티어이미지.setAttribute("src", `https://opgg-static.akamaized.net/images/medals_new/${response.data[0].tier}.png?image=q_auto,f_webp,w_144&v=1684436046850`)
        }

    </script>

</body>
</html>